@namespace Orions.Systems.CrossModules.Portal.Pages
@page "/dashboard"

@using Orions.Infrastructure.HyperMedia
@using Orions.Node.Common

@inherits PortalBaseComponent

@inject IMatToaster Toaster

@if (isDashboardSelected)
{
	<DashboardLayout Data="Data"
					 EnableBetweenBox="true"
					 IsPreviewMode="@isShowViewDashboard"
					 DisableModeOption="false"
					 HyperStore="@HyperStore"
					 OnBackToList="ShowDashboardList">
	</DashboardLayout>
}
else
{
	<DashboardList HyperStore="@HyperStore" OnSelectDesign="OnSelectDesignDashboard" OnSelectView="OnSelectViewDashboard"></DashboardList>
}

@code{

    private bool isDashboardSelected;
    private bool isShowViewDashboard;
    private DashboardData Data { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        await AuthenticateAsync(((CustomAuthenticationStateProvider)AuthenticationStateProvider));
    }

    private void ShowDashboardList()
    {
        Data = null;
        isDashboardSelected = false;
    }

    private void OnSelectDesignDashboard(DashboardData data)
    {
        Data = data;
        isShowViewDashboard = false;
        isDashboardSelected = true;
    }

    private void OnSelectViewDashboard(DashboardData data)
    {
        Data = data;
        isShowViewDashboard = true;
        isDashboardSelected = true;

    }

    private void ShowToaster(MatToastType type, string title, string message)
    {
        Toaster.Add(message, type, title, "", config =>
        {
            config.ShowCloseButton = false;
            config.ShowProgressBar = false;
            config.MaximumOpacity = 100;
        });
    }
}
